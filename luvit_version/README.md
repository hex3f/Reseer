# èµ›å°”å·ç§æœ - å¾®æœåŠ¡æ¶æ„

## ğŸš€ å¿«é€Ÿå¯åŠ¨

```bash
cd luvit_version
start.bat
```

ç„¶åè®¿é—®ï¼š**http://127.0.0.1:32400/**

## ğŸ“¦ æœåŠ¡å™¨æ¶æ„

```
æ•°æ®æœåŠ¡å™¨ (5200) â† HTTP API
    â†‘
    â”œâ”€ æ¸¸æˆæœåŠ¡å™¨ (5000)
    â””â”€ æˆ¿é—´æœåŠ¡å™¨ (5100)
```

### å¯åŠ¨çš„æœåŠ¡

1. **æ•°æ®æœåŠ¡å™¨** (5200) - ç»Ÿä¸€æ•°æ®ç®¡ç†
2. **èµ„æºæœåŠ¡å™¨** (32400) - æä¾›ç½‘é¡µå’Œèµ„æº
3. **ç™»å½•IPæœåŠ¡å™¨** (32401) - æä¾› ip.txt
4. **ç™»å½•æœåŠ¡å™¨** (1863) - å¤„ç†ç™»å½•
5. **æ¸¸æˆæœåŠ¡å™¨** (5000) - æ¸¸æˆé€»è¾‘
6. **æˆ¿é—´æœåŠ¡å™¨** (5100) - å®¶å›­ç³»ç»Ÿ

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### ç»Ÿä¸€å‘½ä»¤å¤„ç†å™¨
- âœ… å¤„ç†å™¨åªå†™ä¸€æ¬¡ï¼ˆ`handlers/` ç›®å½•ï¼‰
- âœ… æ¸¸æˆæœåŠ¡å™¨å’Œæˆ¿é—´æœåŠ¡å™¨å…±äº«
- âœ… è‡ªåŠ¨æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥æ¨¡å¼

### å¾®æœåŠ¡æ¶æ„
- âœ… æ•°æ®é›†ä¸­ç®¡ç†
- âœ… æœåŠ¡ç‹¬ç«‹éƒ¨ç½²
- âœ… æ˜“äºæ‰©å±•

## ğŸ“ ç›®å½•ç»“æ„

```
luvit_version/
â”œâ”€â”€ start.bat              # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ data_client.lua        # æ•°æ®å®¢æˆ·ç«¯
â”œâ”€â”€ start_dataserver.lua   # æ•°æ®æœåŠ¡å™¨
â”œâ”€â”€ start_gameserver.lua   # æ¸¸æˆæœåŠ¡å™¨
â”œâ”€â”€ start_roomserver.lua   # æˆ¿é—´æœåŠ¡å™¨
â”œâ”€â”€ handlers/              # ç»Ÿä¸€å‘½ä»¤å¤„ç†å™¨
â”‚   â”œâ”€â”€ nono_handlers.lua
â”‚   â”œâ”€â”€ pet_handlers.lua
â”‚   â””â”€â”€ ...
â”œâ”€â”€ gameserver/            # æ¸¸æˆæœåŠ¡å™¨é€»è¾‘
â”œâ”€â”€ roomserver/            # æˆ¿é—´æœåŠ¡å™¨é€»è¾‘
â””â”€â”€ docs/                  # æ–‡æ¡£å’Œåˆ†ææ–‡ä»¶
```

## ğŸ”§ é…ç½®

ç¼–è¾‘å¯åŠ¨è„šæœ¬ä¸­çš„é…ç½®ï¼š

```lua
local conf = {
    dataserver_url = "http://127.0.0.1:5200",  -- æ•°æ®æœåŠ¡å™¨åœ°å€
    gameserver_port = 5000,
    roomserver_port = 5100,
}
```

## ğŸ“Š ç›‘æ§

è®¿é—®æ•°æ®æœåŠ¡å™¨ APIï¼š

```bash
# å¥åº·æ£€æŸ¥
curl http://127.0.0.1:5200/api/health

# ç»Ÿè®¡ä¿¡æ¯
curl http://127.0.0.1:5200/api/stats

# åœ¨çº¿ç”¨æˆ·
curl http://127.0.0.1:5200/api/session/online
```

## ğŸ“– æ–‡æ¡£

è¯¦ç»†æ–‡æ¡£åœ¨ `docs/` ç›®å½•ï¼š
- `MICROSERVICE_ARCHITECTURE.md` - å¾®æœåŠ¡æ¶æ„è®¾è®¡
- å…¶ä»–åˆ†æå’Œä¿®å¤æ–‡æ¡£

## ğŸ’¡ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°å‘½ä»¤

1. åœ¨ `handlers/` åˆ›å»ºæˆ–ç¼–è¾‘å¤„ç†å™¨
2. ä½¿ç”¨ `ctx.dataClient` è®¿é—®æ•°æ®ï¼ˆå¼‚æ­¥ï¼‰
3. æˆ–ä½¿ç”¨ `ctx.getOrCreateUser()` ï¼ˆåŒæ­¥ï¼‰
4. æ¸¸æˆæœåŠ¡å™¨å’Œæˆ¿é—´æœåŠ¡å™¨è‡ªåŠ¨å…±äº«

### ç¤ºä¾‹

```lua
-- handlers/my_handler.lua
local function handleMyCommand(ctx)
    -- å¼‚æ­¥æ¨¡å¼ï¼ˆæ¨èï¼‰
    if ctx.dataClient then
        ctx.dataClient:getOrCreateUser(ctx.userId, function(success, result)
            if success then
                local user = result.data
                -- å¤„ç†é€»è¾‘
                ctx.sendResponse(...)
            end
        end)
        return
    end
    
    -- åŒæ­¥æ¨¡å¼ï¼ˆå…¼å®¹ï¼‰
    local user = ctx.getOrCreateUser(ctx.userId)
    -- å¤„ç†é€»è¾‘
    ctx.sendResponse(...)
end
```

## ğŸ® æ¸¸æˆåŠŸèƒ½

- âœ… ç”¨æˆ·ç™»å½•å’Œæ³¨å†Œ
- âœ… åœ°å›¾ç³»ç»Ÿ
- âœ… ç²¾çµç³»ç»Ÿ
- âœ… æˆ˜æ–—ç³»ç»Ÿ
- âœ… NoNo ç³»ç»Ÿï¼ˆè·¨æœåŠ¡å™¨çŠ¶æ€åŒæ­¥ï¼‰
- âœ… å®¶å›­ç³»ç»Ÿ
- âœ… ä»»åŠ¡ç³»ç»Ÿ
- âœ… å¥½å‹ç³»ç»Ÿ

## ğŸ› æ•…éšœæ’é™¤

### æœåŠ¡å™¨æ— æ³•å¯åŠ¨
- æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
- ç¡®ä¿ `luvit.exe` å­˜åœ¨

### æ— æ³•è®¿é—®ç½‘é¡µ
- ç¡®è®¤èµ„æºæœåŠ¡å™¨å·²å¯åŠ¨ï¼ˆç«¯å£ 32400ï¼‰
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### æ•°æ®ä¸åŒæ­¥
- ç¡®è®¤æ•°æ®æœåŠ¡å™¨å·²å¯åŠ¨ï¼ˆç«¯å£ 5200ï¼‰
- æ£€æŸ¥ `dataserver_url` é…ç½®

## ğŸ“ è®¸å¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ã€‚
